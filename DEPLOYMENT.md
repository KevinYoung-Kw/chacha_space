# å‰å‰ AI åŠ©æ‰‹ - éƒ¨ç½²æŒ‡å—

## ğŸ—ï¸ æ¶æ„æ¦‚è¿°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å‰ç«¯ (React + Vite)                   â”‚
â”‚                    /frontend/dist (é™æ€æ–‡ä»¶)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ HTTP/REST
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åç«¯ (Node.js + Express)                  â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  è®¤è¯æ¨¡å—   â”‚  â”‚   AI å¯¹è¯   â”‚  â”‚  è®°å¿†ç³»ç»Ÿ (Memory)   â”‚ â”‚
â”‚  â”‚  (JWT)     â”‚  â”‚  (MiniMax)  â”‚  â”‚  ä¸Šä¸‹æ–‡å·¥ç¨‹          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  å¾…åŠäº‹é¡¹   â”‚  â”‚  å¥åº·è¿½è¸ª   â”‚  â”‚  å¤©æ°”/TTS æœåŠ¡       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SQLite æ•°æ®åº“                           â”‚
â”‚                    /data/chacha.db                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ å¿«é€Ÿéƒ¨ç½²

### æ–¹å¼ä¸€ï¼šDocker éƒ¨ç½²ï¼ˆæ¨èï¼‰

```bash
# 1. è®¾ç½®ç¯å¢ƒå˜é‡
export JWT_SECRET="your-super-secret-key"
export MINIMAX_API_KEY="your-minimax-api-key"
export MINIMAX_GROUP_ID="your-minimax-group-id"

# 2. ä½¿ç”¨ Docker Compose å¯åŠ¨
docker-compose up -d

# 3. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# 4. è®¿é—®åº”ç”¨
# å‰ç«¯: http://localhost:3001
# API: http://localhost:3001/api
```

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨æ„å»º Docker é•œåƒ

```bash
# æ„å»ºé•œåƒ
docker build -t chacha-assistant:latest .

# è¿è¡Œå®¹å™¨
docker run -d \
  --name chacha \
  -p 3001:3001 \
  -v chacha-data:/app/data \
  -e JWT_SECRET="your-secret-key" \
  -e MINIMAX_API_KEY="your-api-key" \
  -e MINIMAX_GROUP_ID="your-group-id" \
  chacha-assistant:latest
```

### æ–¹å¼ä¸‰ï¼šæœ¬åœ°å¼€å‘

```bash
# 1. å®‰è£…åç«¯ä¾èµ–
cd backend
npm install

# 2. åˆ›å»º .env æ–‡ä»¶
cp .env.example .env
# ç¼–è¾‘ .env å¡«å…¥ä½ çš„é…ç½®

# 3. åˆå§‹åŒ–æ•°æ®åº“
npm run db:init

# 4. å¯åŠ¨åç«¯å¼€å‘æœåŠ¡å™¨
npm run dev

# 5. å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨ï¼ˆæ–°ç»ˆç«¯ï¼‰
cd ..
npm run dev
```

---

## âš™ï¸ ç¯å¢ƒå˜é‡

| å˜é‡å | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `PORT` | å¦ | `3001` | æœåŠ¡ç«¯å£ |
| `NODE_ENV` | å¦ | `development` | ç¯å¢ƒï¼šdevelopment/production |
| `JWT_SECRET` | **æ˜¯** | - | JWT ç­¾åå¯†é’¥ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…é¡»ä¿®æ”¹ï¼‰ |
| `MINIMAX_API_KEY` | **æ˜¯** | - | MiniMax API å¯†é’¥ |
| `MINIMAX_GROUP_ID` | å¦ | - | MiniMax Group ID |
| `DATABASE_PATH` | å¦ | `./data/chacha.db` | SQLite æ•°æ®åº“è·¯å¾„ |
| `CORS_ORIGIN` | å¦ | `*` | å…è®¸çš„è·¨åŸŸæ¥æº |

---

## ğŸ—„ï¸ æ•°æ®åº“ç»“æ„

### ç”¨æˆ·è¡¨ (users)
- `id`: ç”¨æˆ· ID (UUID)
- `username`: ç”¨æˆ·å (å”¯ä¸€)
- `password_hash`: å¯†ç å“ˆå¸Œ
- `name`: æ˜¾ç¤ºåç§°
- `gender`, `identity`, `expectations`: ç”¨æˆ·èµ„æ–™

### å¾…åŠè¡¨ (todos)
- `id`: å¾…åŠ ID
- `user_id`: å…³è”ç”¨æˆ·
- `text`: å†…å®¹
- `completed`: å®ŒæˆçŠ¶æ€
- `priority`: ä¼˜å…ˆçº§ (high/medium/low)
- `category`: åˆ†ç±»

### å¥åº·è®°å½•è¡¨ (health_records)
- `id`: è®°å½• ID
- `user_id`: å…³è”ç”¨æˆ·
- `type`: ç±»å‹ (water/calories/sleep/exercise)
- `value`: æ•°å€¼
- `metadata`: é¢å¤–ä¿¡æ¯ (JSON)

### å¯¹è¯æ¶ˆæ¯è¡¨ (messages)
- `id`: æ¶ˆæ¯ ID
- `user_id`: å…³è”ç”¨æˆ·
- `session_id`: ä¼šè¯ ID
- `role`: è§’è‰² (user/assistant)
- `content`: å†…å®¹

### è®°å¿†è¡¨ (memories)
- `id`: è®°å¿† ID
- `user_id`: å…³è”ç”¨æˆ·
- `type`: ç±»å‹ (fact/preference/event/relationship)
- `content`: å†…å®¹
- `importance`: é‡è¦æ€§ (1-10)

---

## ğŸ“¡ API ç«¯ç‚¹

### è®¤è¯
- `POST /api/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•
- `GET /api/auth/profile` - è·å–ç”¨æˆ·ä¿¡æ¯
- `PUT /api/auth/profile` - æ›´æ–°ç”¨æˆ·ä¿¡æ¯

### å¯¹è¯
- `POST /api/chat/message` - å‘é€æ¶ˆæ¯å¹¶è·å– AI å›å¤
- `GET /api/chat/history` - è·å–å¯¹è¯å†å²
- `GET /api/chat/sessions` - è·å–ä¼šè¯åˆ—è¡¨
- `POST /api/chat/sessions` - åˆ›å»ºæ–°ä¼šè¯

### å¾…åŠ
- `GET /api/todos` - è·å–å¾…åŠåˆ—è¡¨
- `POST /api/todos` - åˆ›å»ºå¾…åŠ
- `PUT /api/todos/:id` - æ›´æ–°å¾…åŠ
- `PATCH /api/todos/:id/toggle` - åˆ‡æ¢å®ŒæˆçŠ¶æ€
- `DELETE /api/todos/:id` - åˆ é™¤å¾…åŠ

### å¥åº·
- `GET /api/health/summary` - è·å–å¥åº·æ•°æ®æ‘˜è¦
- `POST /api/health/water` - è®°å½•å–æ°´
- `POST /api/health/calories` - è®°å½•çƒ­é‡
- `POST /api/health/sleep` - è®°å½•ç¡çœ 
- `POST /api/health/exercise` - è®°å½•è¿åŠ¨
- `PUT /api/health/goals` - æ›´æ–°å¥åº·ç›®æ ‡

### å¤©æ°”
- `GET /api/weather/city/:name` - æ ¹æ®åŸå¸‚è·å–å¤©æ°”
- `GET /api/weather/location` - æ ¹æ®ç»çº¬åº¦è·å–å¤©æ°”
- `GET /api/weather/auto` - è‡ªåŠ¨è·å–å¤©æ°”

### è¯­éŸ³
- `POST /api/tts/synthesize` - åˆæˆè¯­éŸ³
- `GET /api/tts/voices` - è·å–å¯ç”¨å£°éŸ³åˆ—è¡¨

### è®°å¿†
- `GET /api/memories` - è·å–è®°å¿†åˆ—è¡¨
- `GET /api/memories/relevant` - è·å–ç›¸å…³è®°å¿†
- `POST /api/memories` - æ·»åŠ è®°å¿†
- `DELETE /api/memories/:id` - åˆ é™¤è®°å¿†

---

## ğŸ” å®‰å…¨å»ºè®®

1. **ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä¿®æ”¹ JWT_SECRET**
   ```bash
   # ç”Ÿæˆéšæœºå¯†é’¥
   openssl rand -base64 32
   ```

2. **ä½¿ç”¨ HTTPS**
   - å»ºè®®ä½¿ç”¨ Nginx æˆ– Traefik ä½œä¸ºåå‘ä»£ç†
   - é…ç½® SSL è¯ä¹¦

3. **é™åˆ¶ CORS**
   ```bash
   CORS_ORIGIN=https://your-domain.com
   ```

4. **å®šæœŸå¤‡ä»½æ•°æ®åº“**
   ```bash
   # å¤‡ä»½
   docker cp chacha:/app/data/chacha.db ./backup/
   
   # æ¢å¤
   docker cp ./backup/chacha.db chacha:/app/data/
   ```

---

## ğŸ”§ å¸¸è§é—®é¢˜

### 1. Docker æ„å»ºå¤±è´¥
```bash
# æ¸…ç†ç¼“å­˜é‡æ–°æ„å»º
docker-compose build --no-cache
```

### 2. æ•°æ®åº“æƒé™é—®é¢˜
```bash
# ç¡®ä¿æ•°æ®ç›®å½•æœ‰å†™å…¥æƒé™
chmod 777 ./data
```

### 3. MiniMax API è¿æ¥å¤±è´¥
- æ£€æŸ¥ API Key æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ç½‘ç»œæ˜¯å¦èƒ½è®¿é—® api.minimaxi.com
- æŸ¥çœ‹åç«¯æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯

### 4. è¯­éŸ³åˆæˆä¸å·¥ä½œ
- ç¡®ä¿ MiniMax API Key æœ‰ TTS æƒé™
- æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦æ”¯æŒ AudioContext

---

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### æŸ¥çœ‹æ—¥å¿—
```bash
# Docker Compose
docker-compose logs -f chacha

# å•ç‹¬å®¹å™¨
docker logs -f chacha-assistant
```

### å¥åº·æ£€æŸ¥
```bash
curl http://localhost:3001/api/health-check
```

### æ€§èƒ½ç›‘æ§ï¼ˆå¯é€‰ï¼‰
å¯ä»¥æ¥å…¥ Prometheus + Grafana è¿›è¡Œç›‘æ§ï¼Œéœ€è¦é¢å¤–é…ç½®ã€‚

---

## ğŸš€ ç”Ÿäº§éƒ¨ç½²æ¸…å•

- [ ] ä¿®æ”¹ JWT_SECRET ä¸ºå®‰å…¨çš„éšæœºå­—ç¬¦ä¸²
- [ ] é…ç½®æ­£ç¡®çš„ MiniMax API Key
- [ ] è®¾ç½® CORS_ORIGIN ä¸ºå®é™…åŸŸå
- [ ] é…ç½® HTTPS (å»ºè®®ä½¿ç”¨ Nginx)
- [ ] è®¾ç½®æ•°æ®å·æŒä¹…åŒ–
- [ ] é…ç½®æ—¥å¿—æ”¶é›†
- [ ] è®¾ç½®å®šæœŸå¤‡ä»½
- [ ] é…ç½®å¥åº·æ£€æŸ¥å‘Šè­¦

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2026-01-17)
- âœ… å‰åç«¯åˆ†ç¦»æ¶æ„
- âœ… ç”¨æˆ·æ³¨å†Œ/ç™»å½•ç³»ç»Ÿ (JWT)
- âœ… SQLite æ•°æ®æŒä¹…åŒ–
- âœ… è®°å¿†ç³»ç»Ÿï¼ˆä¸Šä¸‹æ–‡å·¥ç¨‹ï¼‰
- âœ… Docker ä¸€é”®éƒ¨ç½²
- âœ… å®Œæ•´çš„ API æ–‡æ¡£

---

**æŠ€æœ¯æ ˆ**: Node.js + Express + TypeScript + SQLite + React + Vite + Docker
